#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "üîç Running pre-push checks..."
echo ""

# Run ESLint
echo "‚ñ∂ Running ESLint..."
npm run lint
LINT_EXIT_CODE=$?

# Run tests
echo ""
echo "‚ñ∂ Running tests..."
npm test
TEST_EXIT_CODE=$?

# Show results
echo ""
echo "=========================================="
if [ $LINT_EXIT_CODE -ne 0 ] || [ $TEST_EXIT_CODE -ne 0 ]; then
  echo "‚ö†Ô∏è  WARNING: Push completed with errors!"
  echo "=========================================="

  if [ $LINT_EXIT_CODE -ne 0 ]; then
    echo "‚ùå ESLint found issues"
  fi

  if [ $TEST_EXIT_CODE -ne 0 ]; then
    echo "‚ùå Tests failed"
  fi

  echo ""
  echo "Please fix these issues before the next push."
  echo "=========================================="
else
  echo "‚úÖ All checks passed!"
  echo "=========================================="
fi

# Always exit 0 to allow push (non-blocking)
exit 0
